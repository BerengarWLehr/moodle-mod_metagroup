define(["jquery"],function(a){"use strict";var b={initialize:function(){a(function(){a("#id_link").on("change",function(){b.loadGroups(this)}),a("#course_filter").keyup(b.debounce(function(b){var c=a("#course_filter").val().trim();if(13===b.code)return void b.preventDefault();var d;d=!1,a("#id_link").find("option").each(function(b,e){var f=c.replace("(","\\(").replace(")","\\)").replace("[","\\[").replace("]","\\]").replace(".","\\."),g=new RegExp(".*"+f+".*","i");g.test(a(e).text())?(a(e).css("display","inline"),d||(a("#id_link").val(a(e).val()).change(),d=!0)):a(e).css("display","none")})},250))})},loadGroups:function(b){a.ajax({url:M.cfg.wwwroot+"/enrol/metagroup/groups.json.php",type:"POST",data:{courseid:a(b).val(),sesskey:a("form :input[name=sesskey]").val()},success:function(b){var c=JSON.parse(b);Object.keys(c).length>0?a("#id_groups").find("option").remove().end().append('<option value="0">All</option>').val("0"):a("#id_groups").find("option").remove(),Object.keys(c).map(function(b){a("#id_groups").append(a("<option></option>").attr("value",c[b].id).text(c[b].name))})}})},debounce:function(a,b,c){function d(a){var b=typeof a;return!!a&&("object"===b||"function"===b)}function e(){o&&clearTimeout(o),k&&clearTimeout(k),r=0,k=o=q=void 0}function f(b,c){c&&clearTimeout(c),k=o=q=void 0,b&&(r=u(),l=a.apply(n,j),o||k||(j=n=void 0))}function g(){var a=b-(u()-m);0>=a||a>b?f(q,k):o=setTimeout(g,a)}function h(){f(t,o)}function i(){j=arguments,m=u(),n=this,q=t&&(o||!p);var c,d;if(s===!1)d=p&&!o;else{k||p||(r=m);var e=s-(m-r);c=0>=e||e>s,c?(k&&(k=clearTimeout(k)),r=m,l=a.apply(n,j)):k||(k=setTimeout(h,e))}return c&&o?o=clearTimeout(o):o||b===s||(o=setTimeout(g,b)),d&&(c=!0,l=a.apply(n,j)),!c||o||k||(j=n=void 0),l}var j,k,l,m,n,o,p,q,r=0,s=!1,t=!0;if("function"!=typeof a)throw new TypeError("First argument has to be a function");b=0>b?0:+b||0,c===!0?(p=!0,t=!1):d(c)&&(p=!!c.leading,s="maxWait"in c&&Math.max(+c.maxWait||0,b),t="trailing"in c?!!c.trailing:t);var u=Date.now||function(){return(new Date).getTime()};return i.cancel=e,i}};return b});