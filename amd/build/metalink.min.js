define(["exports"],function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var i="object"==typeof t&&t&&t.Object===Object&&t,t="object"==typeof self&&self&&self.Object===Object&&self,i=i||t||Function("return this")(),o=i,r=/\s/;var u=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},a=/^\s+/;var t=i.Symbol,i=Object.prototype,c=i.hasOwnProperty,d=i.toString,l=t?t.toStringTag:void 0;var s=Object.prototype.toString;var f=function(e){var t=c.call(e,l),n=e[l];try{var i=!(e[l]=void 0)}catch(e){}var o=d.call(e);return i&&(t?e[l]=n:delete e[l]),o},v=function(e){return s.call(e)},m=t?t.toStringTag:void 0;var p=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(m&&m in Object(e)?f:v)(e)},b=function(e){return null!=e&&"object"==typeof e};var y=function(e){return e&&e.slice(0,u(e)+1).replace(a,"")},h=n,g=function(e){return"symbol"==typeof e||b(e)&&"[object Symbol]"==p(e)},w=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,j=/^0o[0-7]+$/i,_=parseInt;var S=n,A=function(){return o.Date.now()},O=function(e){if("number"==typeof e)return e;if(g(e))return NaN;if(h(e)&&(t="function"==typeof e.valueOf?e.valueOf():e,e=h(t)?t+"":t),"string"!=typeof e)return 0===e?e:+e;e=y(e);var t=T.test(e);return t||j.test(e)?_(e.slice(2),t?2:8):w.test(e)?NaN:+e},M=Math.max,$=Math.min;var L=function(i,n,e){var o,r,u,a,c,d,l=0,s=!1,f=!1,t=!0;if("function"!=typeof i)throw new TypeError("Expected a function");function v(e){var t=o,n=r;return o=r=void 0,l=e,a=i.apply(n,t)}function m(e){var t=e-d;return void 0===d||n<=t||t<0||f&&u<=e-l}function p(){var e,t=A();if(m(t))return b(t);c=setTimeout(p,(t=n-((e=t)-d),f?$(t,u-(e-l)):t))}function b(e){return c=void 0,t&&o?v(e):(o=r=void 0,a)}function y(){var e=A(),t=m(e);if(o=arguments,r=this,d=e,t){if(void 0===c)return l=t=d,c=setTimeout(p,n),s?v(t):a;if(f)return clearTimeout(c),c=setTimeout(p,n),v(d)}return void 0===c&&(c=setTimeout(p,n)),a}return n=O(n)||0,S(e)&&(s=!!e.leading,f="maxWait"in e,u=f?M(O(e.maxWait)||0,n):u,t="trailing"in e?!!e.trailing:t),y.cancel=function(){void 0!==c&&clearTimeout(c),o=d=r=c=void(l=0)},y.flush=function(){return void 0===c?a:b(A())},y};let q={};async function H(e){13!==e.code?3<=e.target.value.trim().length&&x():e.preventDefault()}async function x(){const e=await window.fetch("/enrol/metagroup/courses.json.php",{method:"POST",body:new window.FormData(document.querySelector("form"))}).then(e=>e.json()),t=document.querySelector("#id_link");if(0===e.length)return t.setAttribute("disabled","disabled"),t.setAttribute("size",1),t.innerHTML=`<option>${q.no_courses}</option>`,void window.setTimeout(()=>{t.value="",k(!1)});t.innerHTML=e.map(e=>`<option value="${e.id}">${e.name} [${e.idnumber}]</option>`).join(""),t.removeAttribute("disabled"),t.setAttribute("size",Math.min(10,e.length)),window.setTimeout(()=>{t.value=e[0].id,k(e[0].id)})}async function E(e){k(e.target.value)}async function k(e){const t=document.querySelector("#id_group");if(""===e)return t.setAttribute("disabled","disabled"),t.setAttribute("size",1),void(t.innerHTML="");const n=await window.fetch("/enrol/metagroup/groups.json.php",{method:"POST",body:new window.URLSearchParams({courseid:e})}).then(e=>e.json());if(0===n.length)return t.setAttribute("disabled","disabled"),t.setAttribute("size",1),void(t.innerHTML=`<option>${q.no_groups}</option>`);t.innerHTML=n.map(e=>`<option value="${e.id}">${e.name}</option>`).join(""),t.removeAttribute("disabled"),t.setAttribute("size",Math.min(10,n.length))}e.init=function(e){q=e,document.querySelectorAll("id_error_field_0, id_error_field_1").forEach(e=>e.addEventListener("change",L(H,250)));const t=document.querySelector("#id_search");t.addEventListener("keyup",L(H,250));const n=document.querySelector("#id_link");n.outerHTML=`<select class="custom-select" name=${n.name} id="id_link" disabled></select>`,window.requestAnimationFrame(e=>{const t=document.querySelector("#id_link");t.addEventListener("change",E)});const i=document.querySelector("#id_group");i.outerHTML=`<select class="custom-select" name="${i.name}" id="id_group" disabled></select>`,3<=t.value.trim().length&&x()},Object.defineProperty(e,"__esModule",{value:!0})});
